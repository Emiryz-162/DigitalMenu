@model DigitalMenu.ViewModels.CategoryPageViewModel
@{
    ViewData["Title"] = Model.CategoryName;
}

<!-- Dark Theme Category Page -->
<div class="category-page-dark">
    <!-- Geri Butonu (Sol Üst) -->
    <a asp-controller="Home" asp-action="Index" class="back-arrow">
        <i class="bi bi-arrow-left"></i>
    </a>

    <!-- Kategori Header (Görsel + Başlık) -->
    <div class="category-header" style="background-image: url('@(Model.AllCategories.FirstOrDefault(c => c.Id == Model.CategoryId)?.ImagePath ?? "/images/default-category.jpg")');">
        <div class="category-header-overlay">
            <div class="container">
                <h1 class="category-title">@Model.CategoryName</h1>
            </div>
        </div>
    </div>

    <!-- Ana İçerik -->
    <div class="category-content">
        <div class="container">
            <!-- Kategori Navigasyon Menüsü -->
            @if (Model.AllCategories != null && Model.AllCategories.Any())
            {
                <div class="category-nav-dark mb-4">
                    <div class="category-nav-scroll">
                        @foreach (var cat in Model.AllCategories)
                        {
                            <a asp-controller="Home"
                               asp-action="Category"
                               asp-route-id="@cat.Id"
                               class="category-nav-item-dark @(cat.Id == Model.CategoryId ? "active" : "")">
                                @cat.Name
                            </a>
                        }
                    </div>
                </div>
            }

            <!-- Ürünler -->
            <div class="product-grid-dark">
                @if (Model.Products != null && Model.Products.Any())
                {
                    @foreach (var product in Model.Products)
                    {
                        <div class="product-card-dark"
                             data-product-id="@product.Id"
                             data-product-name="@product.Name"
                             data-product-price="@product.Price.ToString("C2")"
                             data-product-description="@product.Description"
                             data-product-calories="@(product.Calories?.ToString() ?? "")"
                             data-product-image="@product.ImagePath"
                             onclick="openProductModal(this)">
                            <img src="@product.ImagePath" alt="@product.Name">
                            <div class="product-card-body-dark">
                                <h3 class="product-card-title-dark">@product.Name</h3>
                                <p class="product-card-price-dark">@product.Price.ToString("C2")</p>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="empty-state">
                        <i class="bi bi-inbox"></i>
                        <p>Bu kategoride henüz ürün bulunmamaktadır.</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<!-- Ürün Detay Modal -->
<partial name="_ProductDetailModal" />

<!-- Şikayet Butonu -->
<partial name="_ComplaintButton" />

<script>
    // Aktif kategoriye otomatik kaydır
    document.addEventListener('DOMContentLoaded', function() {
        const activeCategory = document.querySelector('.category-nav-item-dark.active');
        if (activeCategory) {
            activeCategory.scrollIntoView({
                behavior: 'smooth',
                block: 'nearest',
                inline: 'center'
            });
        }
    });
</script>